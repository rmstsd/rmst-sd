<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>svg</title>

    <style>
      body {
        margin: 0;
      }
    </style>
  </head>

  <body>
    <svg
      xmlns="http://www.w3.org/2000/svg"
      xmlns:xlink="http://www.w3.org/1999/xlink"
      style="position: absolute; width: 0; height: 0"
      aria-hidden="true"
    >
      <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" id="icon-asset">
        <path
          d="M12.001 18.8754C11.7555 18.8754 11.5565 18.6764 11.5565 18.4309V5.44446C11.5565 5.199 11.7555 5.00002 12.001 5.00002C12.2464 5.00002 12.4454 5.199 12.4454 5.44446V18.4309C12.4454 18.6764 12.2464 18.8754 12.001 18.8754ZM15.15 9.16262C14.8069 9.16262 14.5341 8.89571 14.3864 8.58602C14.2524 8.30503 14.0426 8.07085 13.7571 7.88348C13.2946 7.57996 12.7273 7.4282 12.0552 7.4282C11.5638 7.4282 11.1338 7.50769 10.7652 7.66668C10.4003 7.82567 10.1148 8.04428 9.90884 8.32251C9.70649 8.60074 9.60531 8.91691 9.60531 9.27102C9.60531 9.56731 9.67577 9.82206 9.81669 10.0352C9.96123 10.2448 10.1455 10.4201 10.3695 10.561C10.5936 10.6983 10.8284 10.8121 11.0741 10.9025C11.3199 10.9892 11.5457 11.0596 11.7517 11.1138L12.879 11.4174C13.1681 11.4932 13.4897 11.598 13.8438 11.7317C14.2015 11.8654 14.543 12.0479 14.8682 12.2791C15.197 12.5068 15.468 12.7995 15.6812 13.1572C15.8944 13.5149 16.001 13.9539 16.001 14.4743C16.001 15.0741 15.8438 15.6161 15.5294 16.1003C15.2187 16.5845 14.7634 16.9693 14.1636 17.2548C13.5674 17.5402 12.8429 17.6829 11.9901 17.6829C11.1952 17.6829 10.5068 17.5547 9.9251 17.2981C9.34696 17.0416 8.89167 16.6838 8.55924 16.2249C8.37037 15.9614 8.22859 15.6733 8.1339 15.3609C8.01663 14.9739 8.34491 14.626 8.74925 14.626C9.11086 14.626 9.39424 14.9132 9.53975 15.2442C9.60831 15.4002 9.69882 15.541 9.81127 15.6667C10.0606 15.9377 10.375 16.14 10.7544 16.2737C11.1374 16.4038 11.5493 16.4689 11.9901 16.4689C12.5032 16.4689 12.9639 16.3857 13.3723 16.2195C13.7806 16.0497 14.104 15.8148 14.3424 15.5149C14.5809 15.2114 14.7002 14.8573 14.7002 14.4526C14.7002 14.084 14.5972 13.7841 14.3912 13.5529C14.1853 13.3216 13.9143 13.1337 13.5782 12.9892C13.2422 12.8446 12.879 12.7182 12.4888 12.6098L11.1229 12.2195C10.2557 11.9702 9.56918 11.6143 9.06331 11.1518C8.55744 10.6893 8.3045 10.084 8.3045 9.33606C8.3045 8.71456 8.47252 8.17255 8.80856 7.71004C9.14822 7.24392 9.60351 6.88258 10.1744 6.62603C10.7489 6.36587 11.3903 6.23579 12.0985 6.23579C12.814 6.23579 13.4499 6.36406 14.0064 6.62061C14.5629 6.87355 15.0037 7.22043 15.3289 7.66126C15.5165 7.91275 15.6535 8.18364 15.7399 8.47393C15.8491 8.84049 15.5325 9.16262 15.15 9.16262Z"
          fill="currentColor"
          stroke="currentColor"
          stroke-width="0.2"
        ></path>
        <circle cx="12.001" cy="12" r="10" stroke="currentColor"></circle>
      </symbol>
    </svg>

    <svg class="test" width="100%" height="200">
      <rect x="10%" y="10" width="20%" height="30" stroke="black" fill="transparent" stroke-width="1" />
      <rect x="10" y="50" width="30" height="30" stroke="black" fill="transparent" stroke-width="1" />
    </svg>

    <br />

    <img src="" alt="" />

    <br />

    <canvas></canvas>

    <!-- <svg
      id="qwer"
      width="20"
      height="20"
      fill="currentColor"
      viewBox="0 0 1024 1024"
      focusable="false"
      aria-hidden="true"
    >
      <use xlink:href="#icon-application-07"></use>
    </svg> -->

    <!-- <img src="./assets/avatar.png" alt="" width="100" height="100" /> -->

    <script>
      const svgTestElement = document.querySelector('.test')
      const imgElement = document.querySelector('img')
      const canvas = document.querySelector('canvas')
      const ctx = canvas.getContext('2d')

      window.onresize = () => {
        draw()
      }

      draw()

      function draw() {
        const rect = svgTestElement.getBoundingClientRect()
        const cloned = svgTestElement.cloneNode(true)

        Array.from(cloned.children).forEach(item => {
          for (const iterator of item.attributes) {
            if (iterator.nodeValue.endsWith('%')) {
              iterator.nodeValue = rect.width * (parseFloat(iterator.nodeValue) / 100)
            }
          }
        })

        const svgData = new XMLSerializer().serializeToString(cloned)

        const blob = new Blob([svgData], { type: 'image/svg+xml' })
        const url = URL.createObjectURL(blob)
        const dpr = window.devicePixelRatio

        canvas.style.width = rect.width + 'px'
        canvas.style.height = rect.height + 'px'
        canvas.width = rect.width * dpr
        canvas.height = rect.height * dpr
        ctx.scale(dpr, dpr)

        imgElement.onload = function () {
          ctx.drawImage(imgElement, 0, 0)

          // ctx.fillRect(50, 50, 2, 2)

          // ctx.drawImage(document.querySelector('img'), 0, 0, 1000, 1000, 0, 0, 100, 100)

          // ctx.strokeRect(0, 0, 100, 100)
        }
        imgElement.src = url

        imgElement.width = rect.width
        imgElement.height = rect.height
      }

      //
    </script>
  </body>
</html>
