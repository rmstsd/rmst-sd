<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>sd</title>

    <style>
      .rect {
        width: 100px;
        height: 100px;
        background-color: #ddd;
      }
    </style>
  </head>

  <body style="padding: 20px">
    <div class="rect rect1"></div>

    <main
      class="rect rect2"
      style="background-color: pink; position: relative; opacity: 0.8; left: 50px"
    ></main>

    <span></span>

    <script>
      const div = document.querySelector('div')
      const main = document.querySelector('main')

      div.onmouseenter = () => {
        console.log('div enter')
        setCursor('move')
      }
      div.onmouseleave = () => {
        console.log('div leave')
        setCursor('auto')
      }

      // div.onmouseover = () => {
      //   console.log('div over')
      // }
      // div.onmouseout = () => {
      //   console.log('div out')
      // }

      // ----
      main.onmouseenter = () => {
        console.log('main enter')
        setCursor('move')
      }
      main.onmouseleave = () => {
        console.log('main leave')
        setCursor('auto')
      }

      // main.onmouseover = () => {
      //   console.log('main over')
      // }
      // main.onmouseout = () => {
      //   console.log('main out')
      // }

      function setCursor(p) {
        document.body.style.setProperty('cursor', p)
        document.querySelector('span').innerText = p
      }

      //
    </script>

    <img src="" alt="" hidden />
    <input type="file" onchange="console.log(this.files)" hidden />

    <script type="module">
      const url =
        'https://naturobot-studio.oss-cn-shanghai.aliyuncs.com/test1230/image_library/2023-10-24/c24adfef-4057-425b-a3b4-f3f72998aa59.png'

      function base64ToFile(base64String, fileName = 'file') {
        const [b4Type, b4Str] = base64String.split(',')
        const [type] = b4Type.match(/(?<=:).*(?=;)/)

        const byteCharacters = atob(b4Str)
        const byteLength = byteCharacters.length
        const byteArray = new Uint8Array(byteLength)
        for (let i = 0; i < byteLength; i++) {
          byteArray[i] = byteCharacters.charCodeAt(i)
        }

        const file = new File([byteArray], fileName, { type })

        return file
      }

      function getBase64FromImageUrl(url) {
        return new Promise((resolve, reject) => {
          const img = new Image()
          img.crossOrigin = 'Anonymous'

          img.onload = () => {
            const canvas = document.createElement('canvas')
            canvas.width = img.width
            canvas.height = img.height
            const ctx = canvas.getContext('2d')
            ctx.drawImage(img, 0, 0)
            const base64String = canvas.toDataURL('image/png')

            resolve(base64String)
          }

          img.onerror = () => {
            reject(new Error('Failed to load image'))
          }

          img.src = url
        })
      }

      const b4 = await getBase64FromImageUrl(url)
      const file = base64ToFile(b4, 'xx.png')

      // console.log(file)

      const u = URL.createObjectURL(file)
      // console.log(u)

      document.querySelector('img').src = u
      //
    </script>
  </body>
</html>
